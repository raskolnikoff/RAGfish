@startuml
!theme amiga
actor User

User -> Settings : load()
alt Embedded resources available
    Settings --> DocumentManager : provide embedded RAGpack (.zip), LLMModel
else Embedded resources NOT available
    User -> DocumentManager : selectImportFromDrive()

    alt RAGpack (.zip) available
        DocumentManager -> GoogleDriveService : download("file.zip")
        GoogleDriveService --> DocumentManager : RAGpack (.zip)
        DocumentManager -> RAGpack : extractAndParse(RAGpack.zip)
        DocumentManager --> User : importComplete()
    else RAGpack (.zip) NOT found
        DocumentManager --> User : error("RAGpack (.zip) not found")
        note right: Fallback to embedded resources if available; otherwise, user must import manually
    end
end

User -> UserQuery : ask(question)
UserQuery -> Settings : getDefaultModel()
note right: Get the default model name from Settings
UserQuery -> LLMModel : embed(question)
LLMModel --> UserQuery : queryEmbedding

UserQuery -> VectorStore : findRelevant(queryEmbedding)
VectorStore --> UserQuery : relevantChunks

UserQuery -> AnswerGenerator : generate(relevantChunks, question)
AnswerGenerator --> UserQuery : answer

UserQuery --> User : displayAnswer(answer)
note right: QA thread/history management (multiple question-answer pairs) is implemented in NoesisNoema app. See app source for details.
@enduml